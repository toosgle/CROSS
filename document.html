<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CROSS</title>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="./assets/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="./assets/app.css">
    <link rel="stylesheet" type="text/css" href="./assets/code.css">
    <script type="text/javascript" src="./assets/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="./assets/bootstrap.js"></script>
</head>

<body data-spy="scroll" data-target=".post-toc" data-offset="20">
    <div id="wrapper">
        <div class="navbar navbar-fixed-top navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand logo active" href="#"><span class="fa fa-cloud-upload"></span>CROSS</a>
                </div>
                <div class="collapse navbar-collapse" data-toggle="collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="./index.html">OVERVIEW</a></li>
                        <li><a href="./getting-started.html">Getting started</a></li>
                        <li><a href="./document.html" class="select">Documents</a></li>
                        <li><a href="./api.html">API</a></li>
                    </ul>
                </div>
                <!-- /.nav-collapse -->
            </div>
            <!-- /.container -->
        </div>
        <!-- /.navbar --> 

        <div class="container api-container">
            <div class="row">
                <div class="col-md-3">
                    <div class="post-toc bs-sidebar">
                        <ul class="nav bs-sidenav">   
                            <li class="active"><a href="./document.html">CROSS开发手册</a></li>
                            <li><a href="">Runtime插件开发</a></li>
                            <li><a href="">Runtime调试方法</a></li>
                            <li><a href="">PhoneGap插件开发</a></li>
                            <li><a href="./fps.html">性能对比数据</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="page-container">






<div class="markdown-body">
      <h1>CROSS开发手册</h1>

<h2>简介</h2>

<p>CROSS是一个跨平台的组件库，用来提升传统web组件在移动端的用户体验。</p>

<h2>基础概念</h2>

<p>在开发CROSS组件之前，我们有必要了解一些相关的基础概念，这样有利于后面内容的理解和掌握。</p>

<h3>百度移动云Runtime</h3>

<p>Runtime是百度移动云平台部开发的运行轻应用的底层统一框架，该框架可集成在Native App中，也可独立运行。Runtime提供简单、统一的UI界面级管理轻应用、本地设备、百度开放云能力等；并集成插件中心，用户可根据自己需求添加个性化插件。</p>

<h3>PhoneGap</h3>

<p>PhoneGap是一个用基于HTML，CSS和JavaScript的，创建移动跨平台移动应用程序的快速开发平台。它使开发者能够利用iPhone，Android，Palm，Symbian,WP7,Bada和Blackberry智能手机的核心功能——包括地理定位，加速器，联系人，声音和振动等。你可以开发PhoneGap的插件来扩展webApp的功能。</p>

<h2>环境要求</h2>

<p>CROSS可以运行在浏览器、webView、百度移动云Runtime、PhoneGap等几乎任何web浏览环境。</p>

<h2>文件组织</h2>

<p>CROSS的底层实现代码放在src文件夹中，包括类的创建、基础类、组件的使用等功能。</p>

<p>每个CROSS组件放在component文件夹中以组件名命名的文件夹内：</p>

<ul>
<li>组件的具体实现（可能是一个第三方组件）放在third-party中</li>
<li>组件web端接口文件以 web.组件名.js 的方式命名：如web.slider.js</li>
<li>组件native端接口文件以 native.组件名.js 的方式命名：如native.slider.js</li>
</ul><p>每个组件在最终发布时，以third-party、web端接口文件、native端接口文件的顺序合并，放在dist文件夹中</p>

<p>dome文件夹中存放的是示例文件，test文件夹中存放的是单元测试用例</p>

<pre><code>CROSS
├── component
    └── sample Sample组件文件夹
        ├── native.sample.js Sample组件native端接口文件
        ├── web.sample.js Sample组件web端接口文件
        ├── sample.css Sample组件样式文件
    └── slider Slider组件文件夹
        └── third-party Slider组件所用到的第三方组件
            ├── flipsnap.js flipsnap.js
        ├── native.slider.js Slider组件native端接口文件
        ├── web.slider.js Slider组件web端接口文件
        ├── slider.css Slider组件样式文件
├── demo
    └── demo.html 示例文件
├── dist    合并后的文件
├── src    CROSS的底层实现代码
├── test    单元测试用例
</code></pre>

<h2>组件调用</h2>

<div class="highlight highlight-javascript"><pre><span class="c1">//使用CROSS.use声明对一个组件的调用</span>
<span class="nx">CROSS</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'slider'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">slider</span><span class="p">){</span>
    <span class="c1">//使用slider.create来实例化Slider组件</span>
    <span class="kd">var</span> <span class="nx">sliderInstance</span> <span class="o">=</span> <span class="nx">slider</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
    <span class="c1">//调用Slider组件的公共方法</span>
    <span class="nx">sliderInstance</span><span class="p">.</span><span class="nx">toNext</span><span class="p">();</span>
<span class="p">});</span>
<span class="c1">//使用CROSS.use声明对多个组件的调用</span>
<span class="nx">CROSS</span><span class="p">.</span><span class="nx">use</span><span class="p">([</span><span class="s1">'slider'</span><span class="p">,</span> <span class="s1">'gallery'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">slider</span><span class="p">,</span> <span class="nx">gallery</span><span class="p">){</span>
    <span class="c1">//使用slider.create来实例化Slider组件</span>
    <span class="kd">var</span> <span class="nx">sliderInstance</span> <span class="o">=</span> <span class="nx">slider</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
    <span class="c1">//调用Slider组件的公共方法</span>
    <span class="nx">sliderInstance</span><span class="p">.</span><span class="nx">toNext</span><span class="p">();</span>

    <span class="c1">//使用gallery.create来实例化Gallery组件</span>
    <span class="kd">var</span> <span class="nx">galleryInstance</span> <span class="o">=</span> <span class="nx">gallery</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
    <span class="c1">//调用Gallery组件的公共方法</span>
    <span class="nx">galleryInstance</span><span class="p">.</span><span class="nx">toNext</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<h2>组件开发流程</h2>

<p>开发CROSS组件的一般流程是：</p>

<ul>
<li>确定组件功能</li>
<li>确定组件所支持的配置项以及暴露的公共方法</li>
<li>在component文件夹中新建以组件名（小写）命名的文件夹，并在其中新建web端接口文件和native端接口文件（文件命名方式参见‘文件组织’中的描述）</li>
<li>分别完成组件的web端和native端的具体实现（web端实现放在组件文件夹的third-party文件夹中，native端实现需要发布到对应的平台）</li>
<li>完成web端接口文件和native端接口文件中的方法代理</li>
<li>在CROSS文件夹中运行grunt命令，合并组件到dist文件夹</li>
</ul><h2>接口文件</h2>

<p>每个CROSS组件必须有两个接口文件（web端接口文件和native端接口文件），并且这两个文件中提供的公共方法必须一致（方法名、参数、返回值）。
接口文件中暴露出的方法，可以是组件功能的具体实现，也可以直接代理third-party中组件的具体实现。</p>

<p>接口文件其实就是各个端组件的类，用来向用户暴露组件的公共方法.</p>

<p>我们使用CROSS.define方法来定义一个类，CROSS.define方法有三个参数：</p>

<ul>
<li>第一个参数是类名，类名前必须加上Web或者Native作为标识，比如web端slider的类名就是WebSlider，native端slider的类名就是NativeSlider</li>
<li>第二个参数是一个对象，用来暴露组件的方法；其中_init方法是必须实现的一个方法（参见CROSS API）</li>
<li>第三个参数指定类的基类，比如web端slider的基类就是CROSS.WebBase，native端slider的基类就是CROSS.NativeBase</li>
</ul><p>以slider为例，slider使用的第三方组件flipsnap来实现图片的轮播功能（见component/slider/third-party）;</p>

<p>在WebSlider的init方法中初始化flipsnap，并将flipsnap实例作为WebSlider实例的一个属性，这样，WebSlider暴露出的toNext方法就直接转发到flipsnap实例的方法。</p>

<div class="highlight highlight-javascript"><pre><span class="nx">CROSS</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span> <span class="s1">'WebSlider'</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_instance</span> <span class="o">=</span> <span class="nx">Flipsnap</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">toNext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_instance</span><span class="p">.</span><span class="nx">toNext</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="nx">CROSS</span><span class="p">.</span><span class="nx">WebBase</span><span class="p">);</span>
</pre></div>

<p>而NativeSlider中的toNext则是直接通过exec通知Native组件执行对应的toNext方法。</p>

<div class="highlight highlight-javascript"><pre><span class="nx">CROSS</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span> <span class="s1">'NativeSlider'</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">toNext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_exec</span><span class="p">(</span> <span class="s1">'toNext'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){},</span> <span class="kd">function</span><span class="p">(){},</span> <span class="p">[]</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="nx">CROSS</span><span class="p">.</span><span class="nx">NativeBase</span><span class="p">);</span>
</pre></div>

<h2>发布组件</h2>

<p>组件的发布分为两个部分。</p>

<ul>
<li>组件的web部分跟产品代码一同发布上线</li>
<li>组件的native部分需要发布到runtime的插件体系中；如果是phonegap应用，直接将插件打包到app中</li>
</ul>
    </div>









                    </div>
                </div>
            </div>
        </div>


        <div id="footer" class="footer">
            <div class="footer-inner container">
                <div class="row">
                    <p class="copyright">&copy;2014 Baidu Fex Team</p>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var navbarToggle = document.querySelector('.navbar-toggle');
        var navbarCollapse = document.querySelector('.navbar-collapse');
        navbarToggle.onclick = function(){
            if( navbarCollapse.getAttribute('data-toggle') === 'collapse' ){
                navbarCollapse.className = "navbar-collapse";
                navbarCollapse.setAttribute('data-toggle', '');
            }else{
                navbarCollapse.className = "navbar-collapse collapse";
                navbarCollapse.setAttribute('data-toggle', 'collapse');
            }
        }
    </script>
</body>
</html>